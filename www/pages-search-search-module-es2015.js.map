{"version":3,"sources":["./src/app/pages/search/search.page.html","./src/app/pages/search/search-routing.module.ts","./src/app/pages/search/search.module.ts","./src/app/pages/search/search.page.scss","./src/app/pages/search/search.page.ts"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAe,sVAAuR,+mBAA+mB,4BAA4B,8IAA8I,MAAM,wyBAAwyB,E;;;;;;;;;;;;;;;;;;;ACAp0D;AACc;AAEZ;AAE3C,MAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,EAAE;QACR,SAAS,EAAE,uDAAU;KACtB;CACF,CAAC;IAMW,uBAAuB,SAAvB,uBAAuB;CAAG;AAA1B,uBAAuB;IAJnC,8DAAQ,CAAC;QACR,OAAO,EAAE,CAAC,4DAAY,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;QACxC,OAAO,EAAE,CAAC,4DAAY,CAAC;KACxB,CAAC;GACW,uBAAuB,CAAG;AAAH;;;;;;;;;;;;;;;;;;;;;;;;;AChBK;AACM;AACF;AAEA;AAEqB;AAEvB;AAC6B;AAClB;IAazC,gBAAgB,SAAhB,gBAAgB;CAAG;AAAnB,gBAAgB;IAX5B,8DAAQ,CAAC;QACR,OAAO,EAAE;YACP,4DAAY;YACZ,0DAAW;YACX,0DAAW;YACX,qFAAgB;YAChB,mEAAe;YACf,8EAAuB;SACxB;QACD,YAAY,EAAE,CAAC,uDAAU,CAAC;KAC3B,CAAC;GACW,gBAAgB,CAAG;AAAH;;;;;;;;;;;;;ACvB7B;AAAe,6GAA8C,+IAA+I,E;;;;;;;;;;;;;;;;;;;;;;ACAvI;AACT;AACX;AACM;AACd;AACQ;IAQpC,UAAU,SAAV,UAAU;IAwBrB,YACU,OAAgB,EAChB,IAAiB,EACjB,SAA0B,EAClC,SAA2B,EAC3B,KAAqB;QAJb,YAAO,GAAP,OAAO,CAAS;QAChB,SAAI,GAAJ,IAAI,CAAa;QACjB,cAAS,GAAT,SAAS,CAAiB;QAtBpC,8BAA8B;QAC9B,WAAM,GAAa,EAAE,CAAC;QACtB,wBAAwB;QACxB,SAAI,GAAY,KAAK,CAAC;QAStB,yBAAyB;QACzB,SAAI,GAAG,CAAC,CAAC;QAaP,gBAAgB;QAChB,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,SAAS,CAAC,KAAK,CAAC,EAAE;YACxC,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACrB,CAAC,CAAC,CAAC;QACH,qDAAqD;QACrD,IAAI,CAAC,EAAE,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QACtC,qBAAqB;QACrB,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;YAClC,IAAI,MAAM;gBAAE,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACnC,CAAC,CAAC,CAAC;IACL,CAAC;IAED,QAAQ;IACR,CAAC;IAED,QAAQ;QACN,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;YAClB,IAAI,CAAC,IAAI,GAAG,CAAC,CAAC;YACd,IAAI,CAAC,IAAI,GAAG,KAAK,CAAC;YAClB,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC;SACjB;;YAAM,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IACtC,CAAC;IAED,QAAQ,CAAC,OAAgB,EAAE,cAAoB;QAC7C,SAAS;QACT,eAAe;QACf,IAAI,CAAC,IAAI,GAAG,KAAK,CAAC;QAClB,yDAAyD;QACzD,IAAI,CAAC,cAAc,EAAE;YACnB,IAAI,CAAC,IAAI,GAAG,CAAC,CAAC;YACd,IAAI,CAAC,IAAI,GAAG,KAAK,CAAC;YAClB,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC;YAChB,yBAAyB;YACzB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;SACvB;QACD,kBAAkB;QAClB,IAAI,OAAO,EAAE;YACX,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;YACvB,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC;SACzB;QACD,IAAI,CAAC,IAAI,CAAC,OAAO;YAAE,OAAO;QAC1B,yBAAyB;QACzB,IAAI,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,EAAE;YAC3C,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YAClC,yBAAyB;YACzB,0CAA0C;SAC3C;QACD,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;QACrB,4BAA4B;QAC5B,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,QAAQ,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE;YAChD,yBAAyB;YACzB,IAAI,MAAM,GAAG,EAAE,MAAM,EAAE,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,EAAE,CAAC,EAAE,IAAI,CAAC,GAAG,EAAE,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,EAAE,CAAC;YACpF,IAAI,IAAI,CAAC,EAAE;gBAAE,MAAM,CAAC,YAAY,CAAC,GAAG,IAAI,CAAC,EAAE,CAAC;YAC5C,oCAAoC;YACpC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,SAAS,CAAC,KAAK,CAAC,EAAE;gBAC3C,uBAAuB;gBACvB,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;oBACpB,IAAI,CAAC,IAAI,EAAE,CAAC;oBACZ,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;iBACvC;;oBAAM,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;gBACxB,IAAI,cAAc;oBAAE,cAAc,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC;gBACrD,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;YACzB,CAAC,EAAE,GAAG,CAAC,EAAE;gBACP,qBAAqB;gBACrB,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;gBACvB,IAAI,cAAc;oBAAE,cAAc,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC;YACvD,CAAC,CAAC,CAAC;QACL,CAAC,EAAE,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC,CAAC;IACpC,CAAC;IAED,IAAI,CAAC,cAAc;QACjB,wBAAwB;QACxB,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,EAAE,cAAc,CAAC,CAAC;IAC9C,CAAC;IAEK,KAAK;;YACT,2BAA2B;YAC3B,IAAI,KAAK,GAAG,MAAM,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;gBACtC,MAAM,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC;gBACpC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,SAAS,CAAC;gBACvC,OAAO,EAAE;oBACP;wBACE,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,KAAK,CAAC;wBAChC,OAAO,EAAE,GAAG,EAAE;4BACZ,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE;gCACtC,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;gCACjB,IAAI,CAAC,IAAI,GAAG,KAAK,CAAC;4BACpB,CAAC,CAAC,CAAC;wBACL,CAAC;qBACF;oBACD,EAAE,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,EAAE;iBACpC;aACF,CAAC,CAAC;YACH,KAAK,CAAC,OAAO,EAAE,CAAC;QAClB,CAAC;KAAA;CACF;;YAvIQ,sDAAO;YAHP,yEAAW;YACX,8DAAe;YACf,oEAAgB;YAEhB,8DAAc;;AAQV,UAAU;IANtB,+DAAS,CAAC;QACT,QAAQ,EAAE,YAAY;QACtB,0NAAiC;QACjC,aAAa,EAAE,+DAAiB,CAAC,IAAI;;KAEtC,CAAC;mFA0BmB,sDAAO;QACV,yEAAW;QACN,8DAAe;QACvB,oEAAgB;QACpB,8DAAc;GA7BZ,UAAU,CA8HtB;AA9HsB","file":"pages-search-search-module-es2015.js","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar class=\\\"toolbar-searchbar-common\\\">\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button defaultHref=\\\"/home\\\"></ion-back-button>\\n    </ion-buttons>\\n    <ion-searchbar [(ngModel)]=\\\"_keyword\\\" (search)=\\\"doSearch()\\\" (ionClear)=\\\"_keyword=''; doSearch()\\\"\\n      [placeholder]=\\\"'search.search'|translate\\\" class=\\\"ion-text-start\\\">\\n      </ion-searchbar>\\n    <ion-buttons slot=\\\"end\\\">\\n      <ion-button (click)=\\\"show=!show\\\" [color]=\\\"show?'success':'primary'\\\" [disabled]=\\\"!search || search.length < 1\\\">\\n\\t\\t\\t\\t<ion-icon slot=\\\"icon-only\\\" name=\\\"time-outline\\\"></ion-icon>\\n\\t\\t\\t</ion-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content #content>\\n  <!-- history -->\\n  <div slot=\\\"fixed\\\" absolute top start size-full light-bg overflow *ngIf=\\\"show && search && search.length > 0\\\">\\n    <h5 place class=\\\"ion-text-center\\\">{{'search.history'|translate}}</h5>\\n    <ion-button *ngFor=\\\"let item of search\\\" fill=\\\"clear\\\" expand=\\\"block\\\" (click)=\\\"onSearch(item)\\\" text-ellipsis>\\n      <span>{{item}}</span>\\n    </ion-button>\\n  </div>\\n  <ion-button *ngIf=\\\"show && search && search.length > 0\\\"slot=\\\"fixed\\\" absolute bottom end (click)=\\\"clear()\\\" fill=\\\"clear\\\" color=\\\"danger\\\">\\n    <ion-icon slot=\\\"icon-only\\\" src=\\\"assets/svg/icon-clean.svg\\\"></ion-icon>\\n  </ion-button>\\n  <!-- no data -->\\n  <app-no-data *ngIf=\\\"searched && !searching && (!posts || posts.length < 1)\\\"></app-no-data>\\n  <!-- searching -->\\n  <app-loading *ngIf=\\\"searching\\\"></app-loading>\\n  <!-- List posts -->\\n  <app-list-posts *ngIf=\\\"posts\\\" [posts]=\\\"posts\\\"></app-list-posts>\\n  <app-infinite-scroll threshold=\\\"45%\\\" (ionInfinite)=\\\"load($event)\\\" *ngIf=\\\"!over && posts?.length > 0\\\"></app-infinite-scroll>\\n  <!-- Go to top -->\\n  <app-goto-top slot=\\\"fixed\\\" [content]=\\\"content\\\"></app-goto-top>\\n</ion-content>\\n\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { SearchPage } from './search.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: SearchPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class SearchPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { SearchPageRoutingModule } from './search-routing.module';\n\nimport { SearchPage } from './search.page';\nimport { ComponentsModule } from 'src/app/components/components.module';\nimport { TranslateModule } from '@ngx-translate/core';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ComponentsModule,\n    TranslateModule,\n    SearchPageRoutingModule\n  ],\n  declarations: [SearchPage]\n})\nexport class SearchPageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3BhZ2VzL3NlYXJjaC9zZWFyY2gucGFnZS5zY3NzIn0= */\";","import { Component, OnInit, ViewEncapsulation } from '@angular/core';\nimport { CoreService } from 'src/app/services/core.service';\nimport { AlertController } from '@ionic/angular';\nimport { TranslateService } from '@ngx-translate/core';\nimport { Storage } from '@ionic/storage';\nimport { ActivatedRoute } from '@angular/router';\n\n@Component({\n  selector: 'app-search',\n  templateUrl: './search.page.html',\n  encapsulation: ViewEncapsulation.None,\n  styleUrls: ['./search.page.scss'],\n})\nexport class SearchPage implements OnInit {\n  // keyword input\n  _keyword: string;\n  // keyword search\n  keyword: string;\n  // search history from Storage\n  search: string[] = [];\n  // set true show History\n  show: boolean = false;\n  // category id if is search in category\n  id: Object;\n  // search results\n  posts: Object[];\n  // is searching show loading spinner\n  searching: boolean;\n  // set true when searched\n  searched: boolean;\n  // page of search results\n  page = 1;\n  // is over search\n  over: boolean;\n  // translate for this page\n  trans: Object;\n\n  constructor(\n    private storage: Storage,\n    private core: CoreService,\n    private alertCtrl: AlertController,\n    translate: TranslateService,\n    route: ActivatedRoute,\n  ) {\n    // get translate\n    translate.get('search').subscribe(trans => {\n      this.trans = trans;\n    });\n    // get params for search global or search in category\n    this.id = route.snapshot.params['id'];\n    // get search history\n    storage.get('search').then(search => {\n      if (search) this.search = search;\n    });\n  }\n\n  ngOnInit() {\n  }\n\n  doSearch() {\n    if (!this._keyword) {\n      this.page = 1;\n      this.over = false;\n      this.posts = [];\n    } else this.onSearch(this._keyword);\n  }\n\n  onSearch(keyword?: string, infiniteScroll?: any) {\n    // search\n    // hide history\n    this.show = false;\n    // if isn't load more reset search results for new search\n    if (!infiniteScroll) {\n      this.page = 1;\n      this.over = false;\n      this.posts = [];\n      // show searching spinner\n      this.searching = true;\n    }\n    // prepare keyword\n    if (keyword) {\n      this.keyword = keyword;\n      this._keyword = keyword;\n    }\n    if (!this.keyword) return;\n    // prepare add to history\n    if (this.search.indexOf(this.keyword) == -1) {\n      this.search.unshift(this.keyword);\n      // limit store 20 history\n      // this.search = this.search.slice(0, 20);\n    }\n    this.searched = true;\n    // update history to Storage\n    this.storage.set('search', this.search).then(() => {\n      // prepare params request\n      let params = { search: this.keyword.toLowerCase(), t: Date.now(), page: this.page };\n      if (this.id) params['categories'] = this.id;\n      // request search posts with keyword\n      this.core.getPosts(params).subscribe(posts => {\n        // when request success\n        if (posts.length > 0) {\n          this.page++;\n          this.posts = this.posts.concat(posts);\n        } else this.over = true;\n        if (infiniteScroll) infiniteScroll.target.complete();\n        this.searching = false;\n      }, err => {\n        // when request error\n        this.searching = false;\n        if (infiniteScroll) infiniteScroll.target.complete();\n      });\n    }, err => this.searching = false);\n  }\n\n  load(infiniteScroll) {\n    // when scroll to bottom\n    this.onSearch(this.keyword, infiniteScroll);\n  }\n\n  async clear() {\n    // when click clear history\n    let alert = await this.alertCtrl.create({\n      header: this.trans['clear']['title'],\n      message: this.trans['clear']['message'],\n      buttons: [\n        {\n          text: this.trans['clear']['yes'],\n          handler: () => {\n            this.storage.remove('search').then(() => {\n              this.search = [];\n              this.show = false;\n            });\n          }\n        },\n        { text: this.trans['clear']['no'] }\n      ]\n    });\n    alert.present();\n  }\n}\n"],"sourceRoot":"webpack:///"}